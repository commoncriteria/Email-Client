<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../transforms/pp2html.xsl"?>
<?xml-model href="https://github.com/commoncriteria/transforms/raw/master/schemas/CCProtectionProfile.rng" type="application/xml" schematypens="http://relaxng.org/ns/structure/1.0"?>

<PP xmlns="https://niap-ccevs.org/cc/v1" name="Email Clients"
    xmlns:h="http://www.w3.org/1999/xhtml">
  <!-- <inline-comment color='green'> Hello World TLS </inline-comment> -->
  <!-- <inline-comment color='blue' linebreak='yes'> Hello World TLS </inline-comment> -->
  <PPReference title="PP Reference">
    <ReferenceTable>
      <PPTitle>Supporting Document - PP-Module for Email Clients</PPTitle>
      <PPVersion>2.1</PPVersion>
      <PPAuthor>National Information Assurance Partnership</PPAuthor>
      <PPPubDate>2017-12-01</PPPubDate>
      <PPCertificationID>unassigned</PPCertificationID>
      <CCVersion>3.1</CCVersion>
      <Keywords>email; emailclient</Keywords>
      <entry>
        <name>Registration</name>
        <description>National Information Assurance Partnership</description>
      </entry>
    </ReferenceTable>
  </PPReference>

  <RevisionHistory role="draft">
    <entry>
      <version>2.1</version>
      <date>2017-12-01</date>
      <subject>Initial Release - version number chosen for consistency with the associated EP-Module</subject>
    </entry>
  </RevisionHistory>

  <foreword>
    <h:p>
  
  <chapter title="Introduction" id="int">
    <section title="Technology Area and Scope of Supporting Document" id="scope">
The scope of the Email Client PP-Module is to describe the security functionality of a software application that provides email client functionality in terms of <cite linkend="bibCC" /> and to define functional and assurance requirements for products that are used for email communications. This PP-Module is intended for use with the following Base-PP:

                <h:ul>
					<h:li>Protection Profile for Application Software</h:li>
                </h:ul>

Although Assurance Activities are defined mainly for the evaluators to follow, in general they will also help Developers to prepare for evaluation by identifying specific requirements for their TOE. The specific requirements in Assurance Activities may in some cases clarify the meaning of Security Functional Requirements (SFR), and may identify particular requirements for the content of Security Targets (ST) (especially the TOE Summary Specification), user guidance documentation, and possibly supplementary information (e.g. for entropy analysis or cryptographic key management architecture).
    </section>

	<section title="Structure of the Document" id="structure">
<h:p>
	  Assurance Activities can be defined for both SFRs and Security Assurance Requirements (SAR). These are defined in separate sections of the SD.
</h:p><h:p>
If any Assurance Activity cannot be successfully completed in an evaluation then the overall verdict for the evaluation is a ‘fail’. In rare cases there may be acceptable reasons why an Assurance Activity may be modified or deemed not applicable for a particular TOE, but this must be agreed with the Certification Body for the evaluation. 
</h:p><h:p>
In general, if all Assurance Activities (for both SFRs and SARs) are successfully completed in an evaluation then it would be expected that the overall verdict for the evaluation is a ‘pass’. To reach a ‘fail’ verdict when the Assurance Activities have been successfully completed would require a specific justification from the evaluator as to why the Assurance Activities were not sufficient for that TOE. 
</h:p><h:p>
Similarly, at the more granular level of Assurance Components, if the Assurance Activities for an Assurance Component and all of its related SFR Assurance Activities are successfully completed in an evaluation then it would be expected that the verdict for the Assurance Component is a ‘pass’. To reach a ‘fail’ verdict for the Assurance Component when these Assurance Activities have been successfully completed would require a specific justification from the evaluator as to why the Assurance Activities were not sufficient for that TOE. 
</h:p>
	</section>

    <section title="Terminology" id="terminology">
        <glossary>
		    <entry>
            <term>ActiveSync</term>
            <description>Microsoft protocol for synchronizing messaging and calendar data between
              mobile clients and email servers.</description>
          </entry>
          <entry>
            <term>Add-on</term>
            <description>Capabilities or functionality added to an application including plug-ins,
              extensions or other controls.</description>
          </entry>
          <entry> 
            <term><abbr title="Assurance Guidance Documents">AGD</abbr></term>
            <description>Documentation describing the secure preparation and operation of the <abbr linkend="TOE"/>.
            </description>
          </entry>
		  <entry>
            <term><abbr title="Common Criteria">CC</abbr></term>
            <description>Common Criteria for Information Technology Security
              Evaluation.</description>
          </entry>
          <entry>
            <term><abbr title="Common Evaluation Methodology">CEM</abbr></term>
            <description>Common Evaluation Methodology for Information Technology Security
              Evaluation.</description>
          </entry>         
          <entry>
            <term>Email Client</term>
            <description>Application used to send, receive, access and manage email provided by an
              email server. The terms email client and TOE are interchangeable in this
              document.</description>
          </entry>
          <entry>
            <term><abbr title="Internet Message Access Protocol">IMAP</abbr></term>
            <description>Protocol for an email client to retrieve
              email from an email server over TCP/IP; IMAP4 defined in RFC 3501.</description>
          </entry>
          <entry>
            <term><abbr title="Messaging Application Programming Interface">MAPI</abbr></term>
            <description>Open specification used by
              email clients such as Microsoft Outlook and Thunderbird; defined in <cite
                linkend="bibmapispec"/>. </description>
          </entry>
          <entry>
            <term><abbr title="Post Office Protocol">POP</abbr></term>
            <description>Protocol for an email client to retrieve email from
              an email server over TCP/IP; POP3 defined in RFC 1939.</description>
          </entry>		  
          <entry>
            <term><abbr title="Protection Profile">PP</abbr></term>
            <description>An implementation-independent set of security requirements for a category
              of products.</description>
          </entry>
          <entry>
            <term><abbr title="Protection Profile Configuration">PP-Configuration</abbr></term>
            <description>A comprehensive set of security requirements for a product type that consists of at least one PP and at least one PP-Module.</description>
          </entry>
          <entry>
            <term><abbr title="Protection Profile Module">PP-Module</abbr></term>
            <description>An implementation-independent set of security requirements for a specific subset of products described by a PP.</description>
          </entry>
		  <entry>
            <term><abbr title="Remote Procedure Call">RPC</abbr></term>
            <description>Protocol used by Microsoft Exchange to send/receive
              MAPI commands; defined in <cite linkend="bibMSOXCRPC" />.</description>
          </entry>
          <entry>
            <term><abbr title="Secure/Multipurpose Internet Mail Extensions">S/MIME</abbr></term>
            <description> Used to sign
              and/or encrypt messages at the request of the user upon sending email and to verify
              digital signature on a signed message upon receipt.</description>
          </entry>		  
          <entry>
            <term><abbr title="Security Assurance Requirement">SAR</abbr></term>
            <description>A requirement to assure the security of the <abbr linkend="TOE"/>.
            </description>
          </entry>
		  <entry>
            <term><abbr title="Security Functional Requirement">SFR</abbr></term>
            <description>A requirement for security enforcement by the <abbr linkend="TOE"/>.
            </description>
          </entry>
		  <entry>
            <term><abbr title="Security Target">ST</abbr></term>
            <description>A set of implementation-dependent security requirements for a specific
              product.</description>
           </entry>
		    <entry>
            <term><abbr title="Simple Mail Transfer Protocol">SMTP</abbr></term>
            <description>Protocol for an email client to send email
              to an email server over TCP/IP; SMTP defined in RFC 5321.</description>
          </entry>
		   <entry>
            <term><abbr title="Supporting Document">SD</abbr></term>
            <description>A companion document to a PP or PP-Module that provides guidance on the specific Assurance Activities that must be performed in order to evaluate a TOE.</description>
          </entry>
          <entry>
            <term><abbr title="Target of Evaluation">TOE</abbr></term>
            <description>
	      The product under evaluation.
	    </description>
          </entry>
          <entry>
            <term><abbr title="TOE Security Functionality">TSF</abbr></term>
            <description>The security functionality of the product under evaluation.</description>
          </entry>
          <entry>
            <term><abbr title="TOE Summary Specification">TSS</abbr></term>
            <description>A description of how a <abbr linkend="TOE"/> satisfies the SFRs in a <abbr
                linkend="ST"/>. </description>
          </entry>
        </glossary>
      </section>
  </chapter>
  
  
<!-- NOTE: formatting came out pretty good, a couple of suggestions for the template:
1. fourth level subsection title shouldn't be prefaced with sequential number (we want it to say 'FCS_TLS_EXT TLS Protocol' not '1 FCS_TLS_EXT TLS Protocol)
(or, a separate tag should exist for the SFR AA titles)
2. dedicated formatting/tags for TSS, AGD, and Test rather than forcing the continuous manual use of 'para break + italicized header + line break'
-->  
  
  
  <chapter title="Assurance Activities for SFRs" id="mandatory_aas">
The AAs presented in this section capture the actions the evaluator performs to address technology specific aspects covering specific SARs (e.g. ASE_TSS.1, ADV_FSP.1, AGD_OPE.1, and ATE_IND.1) – this is in addition to the CEM work units that are performed in <secref linkend="sar_aas"/>.
<h:br/> 
Regarding design descriptions (designated by the subsections labelled TSS, as well as any required supplementary material that may be treated as proprietary), the evaluator must ensure there is specific information that satisfies the AA. For findings regarding the TSS section, the evaluator’s verdicts will be associated with the CEM work unit ASE_TSS.1-1. Evaluator verdicts associated with the supplementary evidence will also be associated with ASE_TSS.1-1, since the requirement to provide such evidence is specified in ASE in the cPP. 
<h:br/>
For ensuring the guidance documentation provides sufficient information for the administrators/users as it pertains to SFRs, the evaluator’s verdicts will be associated with CEM work units ADV_FSP.1-7, AGD_OPE.1-4, and AGD_OPE.1-5. 
<h:br/>
Finally, the subsection labelled Tests is where the authors have determined that testing of the product in the context of the associated SFR is necessary. While the evaluator is expected to develop tests, there may be instances where it is more practical for the developer to construct tests, or where the developer may have existing tests. Therefore, it is acceptable for the evaluator to witness developer-generated tests in lieu of executing the tests. In this case, the evaluator must ensure the developer’s tests are executing both in the manner declared by the developer and as mandated by the AA. The CEM work units that are associated with the AAs specified in this section are: ATE_IND.1-3, ATE_IND.1-4, ATE_IND.1-5, ATE_IND.1-6, and ATE_IND.1-7.
<h:br/>
The evaluator shall ensure that the selections indicated in the ST are consistent with selections in the dependent components.

<section title="Cryptographic Support (FCS)" id="mandatory_fcs"> 
  <subsection title="Secure/Multipurpose Internet Mail Extensions (S/MIME) (FCS_SMIME_EXT)" stopindex="on" id="fcs_smime_ext">
<subsection title="FCS_SMIME_EXT.1 Secure/Multipurpose Internet Mail Extensions (S/MIME)" id="FCS_SMIME_EXT.1">
  <aactivity>
<h:i>TSS</h:i>
<h:br/>The evaluator shall verify that the version of S/MIME implemented by the email client is present in the TSS. The evaluator shall also verify that the algorithms supported are specified, and that the algorithms specified are those listed for this component.
<h:br/>The evaluator shall verify that the TSS describes the ContentEncryptionAlgorithmIdentifier and whether the required behavior is performed by default or may be configured.
<h:br/>The evaluator shall verify that the TSS describes the digestAlgorithm and whether the required behavior is performed by default or may be configured.
<h:br/>The evaluator shall verify that the TSS describes the AlgorithmIdentifier and whether the required behavior is performed by default or may be configured.
<h:br/>The evaluator shall verify that the TSS describes the retrieval mechanisms for both certificates and certificate revocation as well as the frequency at which these mechanisms are implemented.
<h:br/><h:i>AGD</h:i>
<h:br/>The evaluator shall also review the Operational Guidance to ensure that it contains instructions on configuring the email client such that it complies with the description in the TSS.
<h:br/>If the TSS indicates that the algorithms in FCS_SMIME_EXT.1.2 must be configured to meet the requirement, the evaluator shall verify that the AGD guidance includes the configuration of this ID.
<h:br/>If the TSS indicates that the algorithms in FCS_SMIME_EXT.1.3 must be configured to meet the requirement, the evaluator shall verify that the AGD guidance includes the configuration.
<h:br/>If the TSS indicates that the algorithms in FCS_SMIME_EXT.1.4 must be configured to meet the requirement, the evaluator shall verify that the AGD guidance includes the configuration of this ID.
<h:br/>If the TSS indicates that the mechanisms in FCS_SMIME_EXT.1.7 are configurable, the evaluator shall verify that the AGD guidance includes the configuration of these mechanisms.
<h:br/><h:i>Test</h:i>
<h:br/>The evaluator shall perform the following tests:
<h:br/>These tests can be performed in conjunction with the tests specified in FIA_X509_EXT.1 (defined in <cite linkend="bibApp"/>) for certificate/certificate chain verification and FDP_NOT_EXT.1.
<h:br/>Test 1: The evaluator shall both send and receive a message with no protection (no signature or encryption) and verify that the message is transmitted properly and can be viewed at the receiving agent. This transmission can be performed as part of a number of mechanisms; it is sufficient to observe that the message arrives at the intended recipient with the same content as when sent.
<h:br/>Test 2: The evaluator shall both send and receive a signed message using each of the algorithms specified in the ST corresponding to the requirement and verify that the signature is valid for both received and sent messages. After verifying the signatures are valid, the evaluator shall send a signed message using each of the algorithms specified in the ST and use a maninthemiddle tool to modify at least one byte of the message such that the signature is no longer valid. This can be done by modifying the content of the message over which the signature is calculated or by modifying the signature itself. The evaluator shall verify that the received message fails the signature validation check.
<h:br/>Test 3: The evaluator shall both send and receive an encrypted message using each of the algorithms specified in the ST. The evaluator shall verify that the contents are encrypted in transit and that the received message decrypts. After verifying the message decrypts, the evaluator shall send an encrypted message using each of the algorithms specified in the ST and use a maninthemiddle tool to modify at least one byte of the message such that the encryption is no longer valid. The evaluator shall verify that the received message fails to decrypt.
<h:br/>Test 4: The evaluator shall both send and receive a message that is both signed and encrypted. In addition, the evaluator shall use a maninthemiddle tool to modify at least one byte of the message such that the encryption and signature are no longer valid. The evaluator shall verify that the received message fails to decrypt, fails the signature validation check, and/or both.
<h:br/>Test 5: The evaluator shall send a signed message to the email client using a signature algorithm not supported according to the digestAlgorithm ID (e.g., SHA1). The evaluator shall verify that the email client provides a notification that the contents cannot be verified because the signature algorithm is not supported.
<h:br/>Test 6: The evaluator shall send an encrypted message to the email client using an encryption algorithm not supported according to the AlgorithmIdentifier field. The evaluator shall verify that the email client does not display/decrypt the contents of the message.
<h:br/>Test 7: The evaluator shall send the email client a message signed by a certificate without the digitalSignature bit set. The evaluator shall verify that the email client notifies the user that the signature is invalid.
<h:br/>Test 8: The evaluator shall send the email client a message signed by a certificate without the Email Protection purpose in the extendedKeyUsage. The evaluator shall verify that the email client notifies the user that the signature is invalid.
<h:br/>Test 9: The evaluator shall verify that the email client uses OCSP or downloads the CRL at the assigned frequency.
  </aactivity>
</subsection>
</subsection>

<subsection title="Cryptographic Key Management (FCS_CKM_EXT)" stopindex="on">
<subsection title="FCS_CKM_EXT.3 Protection of Key and Key Material" id="FCS_CKM_EXT.3">
  <aactivity>
<h:i>TSS</h:i>
<h:br/>The evaluator shall verify the TSS for a high level description of method used to protect keys stored in nonvolatile memory.
<h:br/>The evaluator shall verify the TSS to ensure it describes the storage location of all keys and the protection of all keys stored in nonvolatile memory. The description of the key chain shall be reviewed to ensure FCS_COP_EXT.2 is followed for the storage of wrapped or encrypted keys in nonvolatile memory and plaintext keys in nonvolatile memory meet one of the criteria for storage.
  </aactivity>
</subsection>

<subsection title="FCS_CKM_EXT.4 Cryptographic Key Destruction" id="FCS_CKM_EXT.4">
  <aactivity>
<h:i>TSS</h:i>
<h:br/>If the platform provides the key destruction, then the evaluator shall examine the TSS to verify that it describes how the key destruction functionality is invoked.
<h:br/>If the application invokes key destruction, the evaluator shall check to ensure the TSS describes each of the secret keys (keys used for symmetric encryption and/or data authentication), private keys, and CSPs used to generate key; when they are zeroized (for example, immediately after use, on system shutdown, etc.); and the type of zeroization procedure that is performed (overwrite with zeros, overwrite three times with random pattern, etc.). If different types of memory are used to store the materials to be protected, the evaluator shall check to ensure that the TSS describes the zeroization procedure in terms of the memory in which the data are stored (for example, "secret keys stored on a drive are zeroized by overwriting once with zeros, while secret keys stored on the internal hard drive are zeroized by overwriting three times with a random pattern that is changed before each write").
<h:br/><h:i>Test</h:i>
<h:br/>The following test is only for key destruction provided by the email client:
<h:br/>Test 1: For each type of authorization service, encryption mode and encryption operation, a known authorization factor, and chain of keys must be provided to the evaluator with an associated ciphertext data set (e.g. if a passphrase is used to create a intermediate key, then the ciphertext containing the encrypted key as well as the intermediate key itself must be provided to the evaluator.) The evaluator will use the email client in conjunction with a debugging or forensics utility to attempt to authorize themselves, resulting in the generation of a key or decryption of a key. The evaluator will ascertain from the TSS what the vendor defines as "no longer needed" and execute the sequence of actions via the email client to invoke this state. At this point, the evaluator should take a dump of volatile memory and search the retrieved dump for the provided authorization credentials or keys (e.g. if the password was "PaSSw0rd", perform a string search of the forensics dump for "PaSSw0rd"). The evaluator must document each command, program or action taken during this process, and must confirm that no plaintext keying material resides in volatile memory. The evaluator must perform this test three times to ensure repeatability. If during the course of this testing the evaluator finds that keying material remains in volatile memory, they should be able to identify the cause (i.e. execution of the grep command for "PaSSw0rd" caused a false positive) and document the reason for failure to comply with this requirement. The evaluator will repeat this same test, but looking for keying material in nonvolatile memory.
  </aactivity>
</subsection>
</subsection>

<subsection title="Cryptographic Key Chaining (FCS_KYC_EXT)" stopindex="on">
<subsection title="FCS_KYC_EXT.1 Key Chaining" id="FCS_KYC_EXT.1">
  <aactivity>
<h:i>TSS</h:i>
<h:br/>The evaluator shall verify the TSS* describes a high level description of the key hierarchy for all authorizations methods that are used to protect the encryption keys. The evaluator shall examine the TSS to ensure it describes the key chain in detail. The description of the key chain shall be reviewed to ensure it maintains a chain of keys using key wrap that meets FCS_COP_EXT.2. The evaluator shall verify the TSS* to ensure that it describes how the key chain process functions, such that it does not expose any material that might compromise any key in the chain. A high-level description should include a diagram illustrating the key hierarchy implemented and detail where all keys and keying material is stored or what it is derived from. The evaluator shall examine the key hierarchy to ensure that at no point the chain could be broken without a cryptographic exhaust or knowledge of the key within the chain and the effective strength of the data encryption key is maintained throughout the key chain.
<h:br/>*If necessary, this information could be contained in a proprietary document and not appear in the TSS.
  </aactivity>
</subsection>
</subsection>

<subsection title="Initialization Vector Generation (FCS_IVG_EXT)" stopindex="on">
<subsection title="FCS_IVG_EXT.1 Initialization Vector Generation" id="FCS_IVG_EXT.1">
  <aactivity>
<h:i>TSS</h:i>
<h:br/>The evaluator shall ensure the TSS describes how IVs and tweaks are handled (based on the AES mode). The evaluator shall confirm that the IVs and tweaks meet the stated requirements.
<h:br/>If the platform provides the IV generation, then the evaluator shall examine the TSS to verify that it describes how the IV generation is invoked.
  </aactivity>
</subsection>
</subsection>

</section>

<section title="User Data Protection (FDP)" id="mandatory_fdp"> 
<subsection title="Notification (FDP_NOT_EXT)" stopindex="on">
<subsection title="FDP_NOT_EXT.1 Notification of S/MIME Status" id="FDP_NOT_EXT.1">
  <aactivity>
<h:i>TSS</h:i>
<h:br/>The evaluator shall ensure that the TSS describes notifications of S/MIME status, including whether S/MIME status is also indicated upon viewing a list of emails.
<h:br/><h:i>AGD</h:i>
<h:br/>The evaluator shall verify that the AGD guidance provides a description (with appropriate visual figures) of the S/MIME status notification(s), including how each of the following are indicated: encryption, verified and validated signature, and unverified and unvalidated signature.
<h:br/><h:i>Test</h:i>
<h:br/>The evaluator shall perform the following tests and may perform them in conjunction with the tests for FCS_SMIME_EXT.1:
<h:ul>
<h:li>Test 1: The evaluator shall send the client an unencrypted and unsigned email and verify that no notifications are present upon viewing.</h:li>
<h:li>Test 2: The evaluator shall send the client an encrypted email and verify that the encrypted notification is present upon viewing.</h:li>
<h:li>Test 3: The evaluator shall send the client a valid signed email and verify that the signed notification is present upon viewing.</h:li>
<h:li>Test 4: The evaluator shall send the client an invalid signed email (for example, using a certificate that does not contain the correct email address or a certificate that does not chain to the root store) and verify that the invalid signature notification is present upon viewing.</h:li>
</h:ul>
  </aactivity>
</subsection>
</subsection>

<subsection title="S/MIME (FDP_SMIME_EXT)" stopindex="on">
<subsection title="FDP_SMIME_EXT.1 S/MIME" id="FDP_SMIME_EXT.1">
  <aactivity>
<h:i>TSS</h:i>
<h:br/>The evaluator shall verify that the TSS contains a description of the S/MIME implementation and its use to protect mail from undetected modification using digital signatures and unauthorized disclosure using encryption. The evaluator shall verify that the TSS describes whether signature verification and decryption occur at receipt or viewing of the message contents, and whether messages are stored with their S/MIME envelopes.
<h:br/><h:i>AGD</h:i>
<h:br/>The evaluator shall ensure that the AGD guidance includes instructions for configuring a certificate for S/MIME use and instructions for signing and encrypting email.
<h:br/><h:i>Test</h:i>
<h:br/>Tests for this element are performed in conjunction with tests for FCS_SMIME_EXT.1 and FDP_NOT_EXT.1
  </aactivity>
</subsection>
</subsection>
</section>

<section title="Identification and Authentication (FIA)" id="mandatory_fia"> 

<subsection title="X.509 Certificate Handling (FIA_X509_EXT)" stopindex="on">
<subsection title="FIA_X509_EXT.3 X.509 Authentication and Encryption" id="FIA_X509_EXT.3">
  <aactivity>
<h:i>TSS</h:i>
<h:br/>The evaluator shall check the TSS to ensure that it describes how the email client chooses which certificates to use so that the email client can use the certificates.
<h:br/>The evaluator shall examine the TSS to confirm that it describes the behavior of the email client when a connection cannot be established during the validity check of a certificate used in establishing a trusted channel and protecting email.
<h:br/><h:i>AGD</h:i>
<h:br/>The evaluator shall verify that the administrative guidance contains any necessary instructions for configuring the operating environment so that the email client can use the certificates.
<h:br/><h:i>Test</h:i>
<h:br/>The evaluator shall perform the following tests:
<h:ul>
<h:li>Test 1: The evaluator shall perform Test 1 for each function listed in FIA_X509_EXT.2.1 in <cite linkend="bibApp"/> that requires the use of certificates. The evaluator shall demonstrate that using a certificate without a valid certification path results in the function failing. The evaluator shall then load into the platform's root store any certificates needed to validate the certificate to be used in the function, and demonstrate that the function succeeds.</h:li> 
<h:li>Test 2: The evaluator shall demonstrate that using a valid certificate that requires certificate validation checking to be performed in at least some part by communicating with a nonTOE IT entity. The evaluator shall then manipulate the environment so that the email client is unable to verify the validity of the certificate, and observe that the action selected in FIA_X509_EXT.2.2 in <cite linkend="bibApp"/> is performed. If the selected action is administratorconfigurable, then the evaluator shall follow the operational guidance to determine that all supported administrator configurable options behave in their documented manner.</h:li>
</h:ul>
  </aactivity>
</subsection>
</subsection>
</section>

<section title="Security Management (FMT)" id="mandatory_fmt"> 

<subsection title="Management of Functions Behavior (FMT_MOF_EXT)" stopindex="on">
<subsection title="FMT_MOF_EXT.1 Management of Functions Behavior" id="FMT_MOF_EXT.1">
  <aactivity>
The assurance activities for this component will be driven by the selections made by the ST author. If a capability is not selected in the ST, the noted assurance activity does not need to be performed. 
<h:i>TSS</h:i>
<h:br/>The evaluator shall verify that the TSS describes those management functions which may only be configured by the email client platform administrator and cannot be overridden by the user when set according to policy.
<h:br/>Change Password: The evaluator shall examine the Operational Guidance to ensure that it describes how the password/passphrase-based authorization factor is to be changed.
<h:br/>Disable Key Recovery: If the email client supports key recovery, this must be stated in the TSS. The TSS shall also describe how to disable this functionality. This includes a description of how the recovery material is provided to the recovery holder.
<h:br/>Cryptographic Configuration: The evaluator shall determine from the TSS for other requirements (FCS_*) what portions of the cryptographic functionality are configurable.
<h:br/><h:i>AGD</h:i>
<h:br/>The evaluator shall examine the operational guidance to verify that it includes instructions for an email client platform administrator to configure the functions listed in FMT_MOF_EXT.1.1.
<h:br/>Disable Key Recovery: If the email client supports key recovery, the guidance for disabling this capability shall be described in the AGD documentation.
<h:br/>Cryptographic Configuration: The evaluator shall review the AGD documentation to determine that there are instructions for manipulating all of the claimed mechanisms.
<h:br/><h:i>Test</h:i>
<h:br/>The evaluator shall perform the following tests:
<h:ul>
<h:li>Test 1: The evaluator shall verify that functions perform as intended by enabling, disabling, and configuring the functions.</h:li>
<h:li>Test 2: The evaluator shall set management functions which are controlled by the (enterprise) administrator and cannot be overridden by the user. The evaluator shall apply these functions to the client, attempt to override each setting as the user, and ensure that the email client does not permit it.</h:li>
<h:li>Test 3: Disable Key Recovery: If the email client provides key recovery capability, then the evaluator shall devise a test that ensures that the key recovery capability has been or can be disabled following the guidance provided by the vendor</h:li>
</h:ul>
  </aactivity>
</subsection>
</subsection>
</section>

<section title="Protection of the TSF (FPT)" id="mandatory_fpt"> 

<subsection title="Add-On Support (FPT_AON_EXT)" stopindex="on">
<subsection title="FPT_AON_EXT.1 Support for Only Trusted Add-Ons" id="FPT_AON_EXT.1">
  <aactivity>
<h:i>TSS</h:i>
<h:br/>The evaluator shall verify that the TSS describes whether the email client is capable of loading trusted add-ons.
<h:br/><h:i>AGD</h:i>
<h:br/>The evaluator shall examine the operational guidance to verify that it includes instructions on loading trusted add-on sources.
<h:br/><h:i>Test</h:i>
<h:br/>The evaluator shall perform the following test:
<h:ul>
<h:li>Test 1: The evaluator shall create or obtain an untrusted add-on and attempt to load it. The evaluator shall verify that the untrusted add-on is rejected and cannot be loaded.</h:li>
</h:ul>
  </aactivity>
</subsection>
</subsection>
</section>

<section title="Trusted Path/Channels (FTP)" id="mandatory_ftp"> 

<subsection title="Inter-TSF Trusted Channel (FTP_ITC_EXT)" stopindex="on">
<subsection title="FTP_ITC_EXT.1 Inter-TSF Trusted Channel" id="FTP_ITC_EXT.1">
  <aactivity>
<h:i>TSS</h:i>
<h:br/>The evaluator shall examine the TSS to determine that it describes the details of the email client connecting to a Mail Transfer Agent in terms of the trusted connection (i.e., TLS) according to FTP_DIT_EXT.1 in <cite linkend="bibApp"/>, along with email client-specific options or procedures that might not be reflected in the specification.
<h:br/><h:i>AGD</h:i>
<h:br/>The evaluator shall confirm that the operational guidance contains instructions for establishing the connection to the Mail Transfer Agent.
<h:br/><h:i>Test</h:i>
<h:br/>The evaluator shall also perform the following tests:
<h:ul>
<h:li>Test 1: The evaluators shall ensure that the email client is able to initiate communications using any selected or assigned protocols specified in the requirement over TLS, setting up the connections as described in the operational guidance and ensuring that communication is successful.</h:li>
<h:li>Test 2: The evaluators shall ensure that the email client is able to initiate communications with a Mail Transfer Agent using SMTP and any assigned protocols specified in the requirement over TLS, setting up the connections as described in the operational guidance and ensuring that communication is successful.</h:li>
<h:li>Test 3: The evaluator shall ensure, for each communication channel with an authorized IT entity in tests 1 and 2, the channel data is not sent in plaintext. To perform this test, the evaluator shall use a sniffer and a packet analyzer. The packet analyzer must indicate that the protocol in use is TLS.</h:li>
</h:ul>
  </aactivity>
</subsection>
</subsection>
</section>
  </chapter>

  <chapter title="Assurance Activities for Optional SFRs" id="optional_aas">
<section title="Cryptographic Support (FCS)" id="optional_fcs"> 

<subsection title="Cryptographic Key Management (FCS_CKM_EXT)" stopindex="on">
<subsection title="FCS_CKM_EXT.5 Cryptographic Key Derivation (Password/Passphrase Conditioning)" id="FCS_CKM_EXT.5">
  <aactivity>
<h:i>TSS</h:i>
<h:br/>The evaluators shall check the TSS section to determine that it specifies that a capability exists to accept passwords/passphrases with the minimum number of characters specified in the ST in this assignment statement.
<h:br/>The evaluator shall examine the password hierarchy TSS to ensure that the formation of all keys is described and that the key sizes match that described by the ST author. The evaluator shall check that the TSS describes the method by which the password/passphrase is first encoded and then fed to the SHA algorithm. The settings for the algorithm (padding, blocking, etc.) shall be described, and the evaluator shall verify that these are supported by the selections in this component as well as the selections concerning the hash function itself. The evaluator shall verify that the TSS contains a description of how the output of the hash function is used to form the submask that will be input into the function. For the NIST SP 800132based conditioning of the password/passphrase, the required assurance activities will be performed when doing the assurance activities for the appropriate requirements (FCS_COP.1.1(4) in <cite linkend="bibApp"/>). If any manipulation of the key is performed in forming the submask that will be used to form the key, that process shall be described in the TSS. No explicit testing of the formation of the submask from the input password is required.
<h:br/><h:i>AGD</h:i>
<h:br/>The evaluators shall check the Operational Guidance to determine that there are instructions for guidance on how to generate large passwords/passphrases external to the email client and instructions for how to configure the password/passphrase length and optional complexity settings (note to Management section). This is important because many default settings for passwords/passphrases will not meet the necessary entropy needed as specified in this EP.
<h:br/><h:i>Test</h:i>
<h:br/>The evaluator shall also perform the following tests:
<h:ul>
<h:li>Test 1: Ensure that the email client supports passwords/passphrases of 64 characters</h:li>
<h:li>Test 2: Try entering a password/passphrase less than 64 characters.</h:li>
<h:li>Test 3: If the email client supports a password/passphrase length up to a maximum number of characters, n (which would be greater than 64), then ensure that the email client will not accept more than n characters. Conditioning: No explicit testing of the formation of the authorization factor from the input password/passphrase is required.</h:li>
</h:ul>
<h:br/>The evaluator shall verify that the iteration count for PBKDFs performed by the email client comply with NIST SP 800132 by ensuring that the TSS contains a description of the estimated time required to derive key material from passwords and how the email client increases the computation time for passwordbased key derivation (including but not limited to increasing the iteration count).
  </aactivity>
</subsection>
</subsection>

<subsection title="Cryptographic Salt Generation (FCS_SAG_EXT)" stopindex="on">
<subsection title="FCS_SAG_EXT.1 Cryptographic Salt Generation" id="FCS_SAG_EXT.1">
  <aactivity>
<h:i>TSS</h:i>
<h:br/>The evaluator shall ensure the TSS describes how salts are generated. The evaluator shall confirm that the salt is generated using an described in FCS_RBG_EXT.1 in <cite linkend="bibApp"/> or by the Operational Environment. If external function is used for this purpose, the TSS should include the specific API that is called with inputs.
<h:br/>If the email client is relying on random bit generation from the host platform, the evaluator shall verify the TSS includes the name/manufacturer of the external RBG and describes the function call and parameters used when calling the external DRBG function. If different external RBGs are used for different platforms, the TSS identifies each RBG for each platform. Also, the TSS includes a short description of the vendor's assumption for the amount of entropy seeding the external DRBG.
  </aactivity>
</subsection>
<subsection title="FCS_NOG_EXT.1 Cryptographic Nonce Generation" id="FCS_NOG_EXT.1">
  <aactivity>
<h:i>TSS</h:i>
<h:br/>The evaluator shall ensure the TSS describes how nonces are created uniquely.
  </aactivity>
</subsection>
</subsection>
</section>

<section title="User Data Protection  (FDP)" id="optional_fdp"> 

<subsection title="Notification (FDP_NOT_EXT)" stopindex="on">
<subsection title="FDP_NOT_EXT.2 Notification of URI" id="FDP_NOT_EXT.2">
  <aactivity>
<h:i>TSS</h:i>
<h:br/>The evaluator shall verify that the TSS includes a description of how embedded links are rendered and the method by which the URI of the link is displayed.
<h:br/><h:i>AGD</h:i>
<h:br/>The evaluator shall ensure that the AGD guidance includes instructions (with any appropriate visual figures) for viewing the URI of an embedded link.
<h:br/><h:i>Test</h:i>
<h:br/>The evaluator shall perform the following test:
<h:ul>
<h:li>Test 1: The evaluator shall send the client an HTML message with an embedded link whose tag is not the URI itself (for example, "click here"). The evaluator shall view the message and, following the instructions in the AGD guidance, verify that the full URI of the embedded link is displayed.</h:li>
</h:ul>
  </aactivity>
</subsection>
</subsection>

<subsection title="Storage of Persistent Information (FPT_PST_EXT)" stopindex="on">
<subsection title="FDP_PST_EXT.1 Storage of Persistent Information" id="FDP_PST_EXT.1">
  <aactivity>
<h:i>TSS</h:i>
<h:br/>The evaluator shall examine the TSS to determine that it describes all persistent information stored on the platform, and the locations on the platform where these data are stored. The evaluator shall confirm that the persistent data described is limited to the data identified in the selection.
<h:br/><h:i>Test</h:i>
<h:br/>The evaluator shall perform the following tests:
<h:ul>
<h:li>Test 1: The evaluator shall operate the email client so that several messages, signed, encrypted, and unsigned, are processed. The evaluator shall also exercise functionality such as moving messages to folders, writing unsent drafts of messages, etc., as provided by the client. The evaluator shall then examine the client platform to determine that the only persistent information stored is that identified in the TSS.</h:li>
</h:ul>
  </aactivity>
</subsection>
</subsection>

<subsection title="Rendering of Message Content (FDP_REN_EXT)" stopindex="on">
<subsection title="FDP_REN_EXT.1 Rendering of Message Content" id="FDP_REN_EXT.1">
  <aactivity>
<h:i>TSS</h:i>
<h:br/>The evaluator shall ensure that the TSS describes plaintext only mode for sending and receiving messages. The evaluator shall verify that the TSS describes whether the email client is capable of rendering and executing HTML or JavaScript. If the email client can render or execute HTML or JavaScript, this description must indicate how the email client handles received messages that contain HTML or JavaScript while in plaintext only mode, and the evaluator shall ensure that the description indicates that embedded objects of these types are not rendered or executed and images/external resources are not automatically downloaded.
<h:br/><h:i>AGD</h:i>
<h:br/>The evaluator shall examine the AGD guidance and verify that it contains instructions for enabling plaintext only mode.
<h:br/><h:i>Test</h:i>
<h:br/>The evaluator shall perform the following tests:
<h:ul>
<h:li>Test 1: If HTML is selected in FDP_REN_EXT.1.1, the evaluator shall send a message to the client containing HTML embedded objects and shall verify that the HTML renders. The evaluator shall then enable plaintext only mode and verify that the HTML does not render.</h:li>
<h:li>Test 2: If JavaScript is selected in FDP_REN_EXT.1.1, the evaluator shall send a message to the client containing JavaScript embedded objects and shall verify that the JavaScript renders and executes. The evaluator shall then enable plaintext only mode and verify that the JavaScript does not render or execute.</h:li>
</h:ul>
  </aactivity>
</subsection>
</subsection>
</section>
</chapter>

  <chapter title="Assurance Activities for Selection-Based SFRs" id="selection_aas">
<section title="Cryptographic Support (FCS)" id="selection_fcs"> 

<subsection title="Cryptographic Operation (FCS_COP_EXT)" stopindex="on">
<subsection title="FCS_COP_EXT.2 Key Wrapping" id="FCS_COP_EXT.2">
  <aactivity>
<h:i>TSS</h:i>
<h:br/>The evaluator shall examine the TSS to ensure there is a high-level description of how the key is protected and meets the appropriate specification.
  </aactivity>
</subsection>
<subsection title="FCS_SMC_EXT.1 Key Combining" id="FCS_SMC_EXT.1">
  <aactivity>
<h:i>TSS</h:i>
<h:br/>If keys are XORed together to form an intermediate key, the TSS section shall identify how this is performed (e.g., if there are ordering requirements, checks performed, etc.). The evaluator shall also confirm that the TSS describes how the length of the output produced is at least the same as that of the data encryption key.
  </aactivity>
</subsection>
</subsection>
</section>

<section title="Identification and Authentication (FIA)" id="selection_fia"> 
<subsection title="Simple Authentication and Security Layer (FIA_SASL_EXT)" stopindex="on">
<subsection title="FIA_SASL_EXT.1 Simple Authentication and Security Layer (SASL)" id="FIA_SASL_EXT.1">
<h:i>TSS</h:i>
<aactivity>
<h:br/>The evaluator shall examine the TSS to determine that it describes the details of the email client connecting to a Mail Transfer Agent in terms of the SASL connection, along with email clientspecific options or procedures that might not be reflected in the specification.
<h:br/><h:i>AGD</h:i>
<h:br/>The evaluator shall confirm that the operational guidance contains instructions for establishing the connection to the Mail Transfer Agent.
<h:br/><h:i>Test</h:i>
<h:br/>The evaluator shall also perform the following tests:
<h:ul>
<h:li>Test 1: The evaluators shall ensure that the email client is able to initiate communications using POP, IMAP and SMTP and requiring SASL, setting up the connections as described in the operational guidance and ensuring that communication is successful.</h:li>
<h:li>Test 2: The evaluator shall ensure, for each communication channel with an authorized IT entity in tests 1, that a valid SASL handshake is performed. To perform this test, the evaluator shall use a sniffer and a packet analyzer. The packet analyzer must indicate that the protocol in use is SASL.</h:li>
</h:ul>
</aactivity>
</subsection>
</subsection>
</section>

<section title="Protection of the TSF (FPT)" id="selection_fpt"> 
<subsection title="Add-On Support (FPT_AON_EXT)" stopindex="on">
<subsection title="FPT_AON_EXT.2 Trusted Installation and Update for Add-ons" id="FPT_AON_EXT.2">
  <aactivity>
<h:i>TSS</h:i>
<h:br/>The evaluator shall examine the TSS to verify that it states that the email client will reject add-ons from untrusted sources.
<h:br/><h:i>AGD</h:i>
<h:br/>The evaluator shall examine the operational guidance to verify that it includes instructions on how to configure the email client with trusted add-on sources.
<h:br/><h:i>Test</h:i>
<h:br/>The evaluator shall perform the following tests:
<h:ul>
<h:li>Test 1: The evaluator shall create or obtain an add-on signed by a trusted source and attempt to install it. The evaluator shall verify that the signature on the addon is valid and that the add-on can be installed.</h:li>
<h:li>Test 2: The evaluator shall create or obtain an add-on signed with an invalid certificate and attempt to install it. The evaluator shall verify that the signed addon is rejected and cannot be installed.</h:li>
<h:li>Test 3: The evaluator shall create or obtain an add-on signed by a trusted source, modify the addon without resigning it, and attempt to install it. The evaluator shall verify that the signed add-on is rejected and cannot be installed.</h:li>
</h:ul>
  </aactivity>
</subsection>
</subsection>
</section>
</chapter>

<chapter title="Assurance Activities for Objective SFRs" id="objective_aas">
This PP-Module defines no objective SFRs.
  </chapter>
 
   <chapter title="Assurance Activities for SARs" id="sar_aas">
The PP-Module does not define any SARs beyond those defined within the Base-PPs to which it can claim conformance. It is important to note that a TOE that is evaluated against the PP-Module is inherently evaluated against the claimed Base-PP as well. These PPs both include a number of Assurance Activities associated with both SFRs and SARs. Additionally, the PP-Module includes a number of SFR-based Assurance Activities that similarly refine the SARs of the Base-PPs. The evaluation laboratory will evaluate the TOE against the chosen Base-PP and supplement that evaluation with the necessary SFRs that are taken from the PP-Module.
  </chapter>

   <chapter title="Required Supplementary Information" id="supplementary_info">
This Supporting Document has no required supplementary information beyond the ST, operational guidance, and testing.
  </chapter>

  <chapter id="biblio" title="References">
    <bibliography>
      <entry id="bibCC">
        <tag>CC</tag>
        <description>Common Criteria for Information Technology Security Evaluation -
          <h:ul>
            <h:li>
              <h:a href="http://www.commoncriteriaportal.org/files/ccfiles/CCPART1V3.1R5.pdf">Part 1:
                Introduction and General Model</h:a>, CCMB-2017-04-001, Version 3.1 Revision 5, April
              2017.</h:li>
            <h:li>
              <h:a href="http://www.commoncriteriaportal.org/files/ccfiles/CCPART2V3.1R5.pdf">Part 2:
                Security Functional Components</h:a>, CCMB-2017-04-002, Version 3.1 Revision 5, April
              2017.</h:li>
            <h:li>
              <h:a href="http://www.commoncriteriaportal.org/files/ccfiles/CCPART3V3.1R5.pdf">Part 3: 
                Security Assurance Components</h:a>, CCMB-2017-04-003, Version 3.1 Revision 5, April
              2017.</h:li>
          </h:ul></description>
      </entry>
      <entry id="bibApp">
        <tag>AppPP</tag>
        <description>
          <h:a href="https://www.niap-ccevs.org/pp/pp_app_v1.2.htm">Protection Profile for Application Software
          </h:a>
        </description>
      </entry>
	  <entry id="bibMSOXCRPC">
	  <tag>MS-OXCRPC</tag>
	  <description>
	  <h:a href="http://interoperability.blob.core.windows.net/files/MS-OXCRPC/[MS-OXCRPC].pdf">Wire Format Protocol</h:a>
	  </description>
	  </entry>
	  <entry id="bibmapispec">
	  <tag>MS-OXCMAPIHTTP</tag>
	  <description>
	  <h:a href="http://interoperability.blob.core.windows.net/files/MS-OXCMAPIHTTP/[MS-OXCMAPIHTTP].pdf">Messaging Application Programming Interface (MAPI)
Extensions for HTTP</h:a>
	  </description>
	  </entry>
    </bibliography>
  </chapter>


  <appendix title="Acronyms" id="acronyms">
    <acronyms>
	    <entry>
        <term>AES</term>
        <description>Advanced Encryption Standard</description>
      </entry>
      <entry>
        <term>CBC</term>
        <description>Cipher Block Chaining</description>
      </entry>
      <entry>
        <term>CMS</term>
        <description>Cryptographic Message Syntax</description>
      </entry>
      <entry>
        <term>CRL</term>
        <description>Certificate Revocation List</description>
      </entry>
      <entry>
        <term>CSP</term>
        <description>Critical Security Parameter</description>
      </entry>
      <entry>
        <term>DRBG</term>
        <description>Deterministic Random Bit Generator</description>
      </entry>
      <entry>
        <term>ECDSA</term>
        <description>Elliptic Curve Digital Signature Algorithm</description>
      </entry>
      <entry>
        <term>HTML</term>
        <description>HyperText Markup Language</description>
      </entry>
      <entry>
        <term>HTTP</term>
        <description>HyperText Transfer Protocol</description>
      </entry>
      <entry>
        <term>HTTPS</term>
        <description>HyperText Transfer Protocol Secure</description>
      </entry>
      <entry>
        <term>IETF</term>
        <description>Internet Engineering Task Force</description>
      </entry>
      <entry>
        <term>IV</term>
        <description>Initialization Vector</description>
      </entry>
      <entry>
        <term>MTA</term>
        <description>Mail Transfer Agent</description>
      </entry>
      <entry>
        <term>NIST</term>
        <description>National Institute of Standards and Technology</description>
      </entry>
      <entry>
        <term>PBKDF</term>
        <description>Password-Based Key Derivation Function</description>
      </entry>
      <entry>
        <term>PDF</term>
        <description>Portable Document Format</description>
      </entry>
      <entry>
        <term>RBG</term>
        <description>Random Bit Generator</description>
      </entry>
      <entry>
        <term>RFC</term>
        <description>Request for Comment (IETF)</description>
      </entry>
      <entry>
        <term>RSA</term>
        <description>Rivest Shamir Adelman</description>
      </entry>
      <entry>
        <term>TLS</term>
        <description>Transport Layer Security</description>
      </entry>
	  <entry>
        <term>URI</term>
        <description>Uniform Resource Identifier</description>
      </entry>
    </acronyms>
  </appendix>
</PP>
